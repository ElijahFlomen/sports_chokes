--- 
title: "NBA Chokes"
author: "Elijah Flomen, Blake Hartung"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
---
```{r include=FALSE, cache=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```

# Introduction

Overall viewership of basketball in the United States has skyrocketed over the last few years, most notably rising 34% from last season. Perhaps a driving factor for its demand has to do with the notion that basketball is a sport that is well known for its thrilling endings. Unlike sports such as American football or baseball where it is possible for a single team to hold possession of the game for long periods of time, basketball is unique in that the gameflow is going through a constant start-and-stop pace, allowing for constant and rapid changes of possession. 

As a result of basketball's inherent back-and-forth nature, it is not uncommon for a team to, at some point in the game, have a large probability of winning and then end up losing. In the sports community, if at any point a team has a high percentage of winning and then ends up losing a game, that is referred to as a ‘choke.’ For instance, in the context of basketball, if Team A leads Team B by 20 points going into the fourth quarter (12 minutes remaining) and then Team B ends up winning the game, this can likely be classified as a choke by Team A. Given the pace of basketball’s gameflow, matches often result in chokes and we thought that it would be interesting to investigate the data behind to explain these upset endings. For instance, are there teams that are more ‘choke’ prone than others? Do teams tend to have more comebacks when they play at home vs. when they are playing as a visitor? What are the most common reasons for a team to choke? Can we establish a categorical explanation for a choke, what mistakes did a team make for them to lose after such a large lead? Was it due to their fouls, missed shots, turnovers...? How do the individual player stats on a high choke team compare to league averages? Before we dive into the questions that guided our research, we also needed to make some subjective judgements regarding how we defined a choke and selected our data. One of the most crucial of these decisions being to set the maximum win percent threshold to define a subsequent loss as a choke. For the purposes of this analysis, we determined to set this threshold value to be at 90%. Therefore, if at any point in a game, Team A had a 90% chance of winning the game, but the end result was a loss, then we categorized this event to be a choke for Team A. Throughout this entire analysis, we will reference such instances as ‘chokes’. Also, it must be noted that for each instance of a team who ‘choked’, their opponent also experienced a comeback. Given the symmetrical nature of these two occurrences, we will assume that for every time that Team A. choked against Team B, we will also conclude that Team B had a ‘comeback’ against Team A. 
This project will seek to provide an overview of statistical relationships between a range of variables, all focused around games with improbable endings in basketball, over the last four seasons.

<!--chapter:end:index.Rmd-->

```{r include=FALSE, cache=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```
# Data sources

```{r}
bookdown::render_book("02-data.Rmd")
browseURL("02-docs/data.html")
```
Data Sources: 1. Githhub: swar/nba_apiOur central data source for this project came from a Python wrapper for the NBA’s public API. The link to this wrapper and its documentation can be found here. This API is written for Python and as a result a large portion of our data clearing and exporting came from Python scripts and notebooks (which will be discussed in more detail later). This API grants access to a wide variety of baseketball-focused data, however, our project decided to narrow in on a few of its queries. Most importantly, we pulled the play-by-play data which provides a plethora of data at the moment-by-moment level of NBA games. Each row in this dataset corresponds to an event in the game, which falls into 1 of 3 categories. An event can be neutral, such as the beginning and ending of a quarter, or events can favor either of the teams, such as a point scored, a foul committed, turnover etc. In addition to a string description of each event, each row in this dataset also contains each team's win probability at that moment in time which is already calculated by the NBA. Although we do not have the exact formula for how this crucial statistic is calculated, it is intuitively some function of point differential and time remaining in the game. This statistic is obviously critical for our analysis, since we are specifically looking at the games where a team had >90% win probability at some point in time and then lost the game. We used this data set to initially pull every single game from the last 4 NBA seasons and identify the games where a ‘choke’ occurred. We also used this dataset to pull specific player-related data, in particular, how their performance changed over the course of a game that was classified as a ‘choke’.

<!--chapter:end:02-data.Rmd-->

```{r include=FALSE, cache=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```
# Data transformation

<!--chapter:end:03-cleaning.Rmd-->

```{r include=FALSE, cache=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```
# Missing values

```{r}
library(readr)
test_data <- read_csv("game_test.csv")
source("missing_vis_test.R")

test_missing_plot <- missing_vis(test_data, percent=FALSE)
test_missing_plot

```

Plot interpretation:

There are no fully complete cases
There are 3 types of descriptions (home description , away description, neutral description ). Intuitively, since we are looking at play for each row only 1 will appear in the dataset. After looking through the dataset, there are 2 specific cases in which there are both home and away descriptions: steal and turnover and shot attempt and blocked shot. As a result, we will end up merging these columns into a single “description” variable, which will simply describe the play and will not be organized by home/away/neutral. This merged column will not contain missing values. 

No win probabilities exist past the 5 minute mark in the 4th quarter. Due to this, we will not consider any win probabilities past this point in the game. However, given that our main research question is to classify the reasons for a game that ends in an upset, the 5 minute mark in the 4th quarter is a reasonable timeframe of the game to consider as a threshold. 

<!--chapter:end:04-missing.Rmd-->

```{r include=FALSE, cache=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```
# Results

<!--chapter:end:05-results.Rmd-->

```{r include=FALSE, cache=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```
# Interactive component



<!--chapter:end:06-interactive.Rmd-->

```{r include=FALSE, cache=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```
# Conclusion


<!--chapter:end:07-conclusion.Rmd-->

